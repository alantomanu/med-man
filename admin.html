<!doctype html>
<html class="no-js" lang="zxx">

<head>
	<!-- Meta Tags -->
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="keywords" content="Site keywords here">
	<meta name="description" content="">
	<meta name='copyright' content=''>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Title -->
	<title>GMC Kottayam</title>

	<!-- Favicon -->
	<link rel="icon" href="img/title-removebg-preview.png">

	<!-- Google Fonts -->
	<link
		href="https://fonts.googleapis.com/css?family=Poppins:200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap"
		rel="stylesheet">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<!-- Nice Select CSS -->
	<link rel="stylesheet" href="css/nice-select.css">
	<!-- Font Awesome CSS -->
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<!-- icofont CSS -->
	<link rel="stylesheet" href="css/icofont.css">
	<!-- Slicknav -->
	<link rel="stylesheet" href="css/slicknav.min.css">
	<!-- Owl Carousel CSS -->
	<link rel="stylesheet" href="css/owl-carousel.css">
	<!-- Datepicker CSS -->
	<link rel="stylesheet" href="css/datepicker.css">
	<!-- Animate CSS -->
	<link rel="stylesheet" href="css/animate.min.css">
	<!-- Magnific Popup CSS -->
	<link rel="stylesheet" href="css/magnific-popup.css">

	<!-- Medipro CSS -->
	<link rel="stylesheet" href="css/normalize.css">
	<link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="css/responsive.css">

</head>

<body>

	<!-- Preloader -->
	<div class="preloader">
		<div class="loader">
			<div class="loader-outter"></div>
			<div class="loader-inner"></div>

			<div class="indicator">
				<svg width="16px" height="12px">
					<polyline id="back" points="1 6 4 6 6 11 10 1 12 6 15 6"></polyline>
					<polyline id="front" points="1 6 4 6 6 11 10 1 12 6 15 6"></polyline>
				</svg>
			</div>
		</div>
	</div>
	<!-- End Preloader -->


	<!-- Header Area -->
	<header class="header">
		<!-- Topbar -->
		<div class="topbar">
			<div class="container">
				<div class="row">
					<div class="col-lg-6 col-md-5 col-12">
						<!-- Contact -->
						<ul class="top-link">
							<li><a href="#appointment">Appointment</a></li>
							<li><a href="#prescripition">Prescripition</a></li>
							<li><a href="#feedback">Feedback</a></li>

						</ul>
						<!-- End Contact -->
					</div>
					<div class="col-lg-6 col-md-7 col-12">
						<!-- Top Contact -->
						<ul class="top-contact">
							<li><i class="fa fa-phone"></i>0481-2592001</li>
							<li><i class="fa fa-envelope"></i><a
									href="mailto:medicalcollegekottayam@gmail.com">medicalcollegekottayam@gmail.com</a>
							</li>
						</ul>
						<!-- End Top Contact -->
					</div>
				</div>
			</div>
		</div>
		<!-- End Topbar -->
		<!-- Header Inner -->
		<div class="header-inner">
			<div class="container">
				<div class="inner">
					<div class="row">
						<div class="col-lg-3 col-md-3 col-12">
							<!-- Start Logo -->
							<div class="logo">
								<a href="index.html"><img src="img/kmc_logo.webp" alt="#"></a>
							</div>
							<!-- End Logo -->
							<!-- Mobile Nav -->
							<div class="mobile-nav"></div>
							<!-- End Mobile Nav -->
						</div>
						<div class="col-lg-7 col-md-9 col-12">
							<!-- Main Menu -->
							<div class="main-menu" id="appointment">
								<nav class="navigation">
									<ul class="nav menu">
										<li class="active"><a href="#">Home </i></a>

										</li>
										<li><a href="#appointment">Appointment</a></li>
										<li><a href="#prescripition">Prescripition</a></li>

										</li>
										<li><a href="#feedback">Feedback</a></li>
									</ul>
								</nav>
							</div>
							<!--/ End Main Menu -->
						</div>
						<div class="col-lg-2 col-12">
							<div class="get-quote">
								<a href="#prescripition" class="btn">View Prescripition</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--/ End Header Inner -->
	</header>
	<!-- End Header Area -->

	<!-- Error Page -->
	<section class="topap" style="padding: 20px 0;">
    <div class="container">
        <div class="row" >
            <h3 class="hc">Appointment details</h3>
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table id="appointmentTable" class="table">
                        <thead>
                            <tr>
                                <th scope="col">No.</th>
                                <th scope="col">Name</th>
                                <th scope="col">Email</th>
                                <th scope="col">Phone</th>
                                <th scope="col">Department</th>
				<th scope="col">Doctor</th>
                                <th scope="col">Date</th>
                                <th scope="col">Message</th>
                                <th scope="col">Approve</th>
                                <th scope="col">Reject</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyAppoinment">
                            <!-- Table rows will be dynamically added here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="topap" style="padding: 20px 0;">
    <div class="container">
        <div class="row" id="prescripition">
            <h3 class="hc">Medicine Prescripition/Medical Test</h3>
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">No.</th>
                                <th scope="col"> First Name </th>
                                <th scope="col">Last Name</th>
                                <th scope="col">OP Number</th>
                                <th scope="col">Department</th>
                                <th scope="col">Medical checkups needed </th>
                                <th scope="col">prescription and dosage</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyPrescripition">
                            <!-- Table rows will be dynamically added here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="error-page section" style="padding: 20px 0;">
    <div class="container">
        <div class="row" id="feedback">
            <h3 class="hc">Feedback</h3>
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">No.</th>
                                <th scope="col">Name</th>
                                <th scope="col">Email</th>
                                <th scope="col">Phone</th>
                                <th scope="col">Subject</th>
                                <th scope="col">Message</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyFeedback">
                            <!-- Table rows will be dynamically added here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>

	<!--/ End Error Page -->

	<!-- Footer Area -->
	<footer id="footer" class="footer ">
		<!-- Footer Top -->
		<div class="footer-top">
			<div class="container">
				<div class="row">
					<div class="col-lg-3 col-md-6 col-12">
						<div class="single-footer">
							<h2>About Us</h2>
							<p>Government Medical College<br>
								Gandhinager, Kottayam<br>
								Kerala Pin-686008<br>
							</p>
							<!-- Social -->
							
							<!-- End Social -->
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-12">
						<div class="single-footer f-link">
							<h2>Quick Links</h2>
							<div class="row">
								<div class="col-lg-6 col-md-6 col-12">
									<ul>
										<li><a href="#"><i class="fa fa-caret-right" aria-hidden="true"></i>Home</a>
										</li>
										<li><a href="#"><i class="fa fa-caret-right" aria-hidden="true"></i>About Us</a>
										</li>
										<li><a href="#"><i class="fa fa-caret-right" aria-hidden="true"></i>Services</a>
										</li>
										<li><a href="#"><i class="fa fa-caret-right" aria-hidden="true"></i>Our
												Cases</a></li>
										<li><a href="#"><i class="fa fa-caret-right" aria-hidden="true"></i>Other
												Links</a></li>
									</ul>
								</div>
								<div class="col-lg-6 col-md-6 col-12">
									<ul>
										<li><a href="#"><i class="fa fa-caret-right"
													aria-hidden="true"></i>Consuling</a></li>
										<li><a href="#"><i class="fa fa-caret-right" aria-hidden="true"></i>Finance</a>
										</li>
										<li><a href="#"><i class="fa fa-caret-right"
													aria-hidden="true"></i>Testimonials</a></li>
										<li><a href="#"><i class="fa fa-caret-right" aria-hidden="true"></i>FAQ</a></li>
										<li><a href="#"><i class="fa fa-caret-right" aria-hidden="true"></i>Contact
												Us</a></li>
									</ul>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-12">
						<div class="single-footer">
							<h2>Open Hours</h2>
							<p>Government Medical College Hospital Kottayam</p>
							<ul class="time-sidual">
								<li class="day"> Monday - Saturday<span>8.00 am–1.00 pm</span></li>
								<li class="day">CASUALTY<span>24 Hours</span></li>
								<li class="day">15 departments<span>All days</span></li>
							</ul>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-12">
						<div class="single-footer">
							<h2>Newsletter</h2>
							<p>subscribe to our newsletter to get all our news in your inbox.. </p>
							<form action="mail/mail.php" method="get" target="_blank" class="newsletter-inner">
								<input name="email" placeholder="Email Address" class="common-input"
									onfocus="this.placeholder = ''" onblur="this.placeholder = 'Your email address'"
									required="" type="email">
								<button class="button"><i class="icofont icofont-paper-plane"></i></button>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--/ End Footer Top -->
		<!-- Copyright -->
		<div class="copyright">
			<div class="container">
				<div class="row">
					<div class="col-lg-12 col-md-12 col-12">
						<div class="copyright-content">
							<p>© Copyright 2024 | All Rights Reserved by <a href="https://www.wpthemesgrid.com"
									target="_blank">gmckottayam.com</a> </p>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--/ End Copyright -->
	</footer>
	<!--/ End Footer Area -->

	<!-- jquery Min JS -->
	<script src="js/jquery.min.js"></script>
	<!-- jquery Migrate JS -->
	<script src="js/jquery-migrate-3.0.0.js"></script>
	<!-- jquery Ui JS -->
	<script src="js/jquery-ui.min.js"></script>
	<!-- Easing JS -->
	<script src="js/easing.js"></script>
	<!-- Color JS -->
	<script src="js/colors.js"></script>
	<!-- Popper JS -->
	<script src="js/popper.min.js"></script>
	<!-- Bootstrap Datepicker JS -->
	<script src="js/bootstrap-datepicker.js"></script>
	<!-- Jquery Nav JS -->
	<script src="js/jquery.nav.js"></script>
	<!-- Slicknav JS -->
	<script src="js/slicknav.min.js"></script>
	<!-- ScrollUp JS -->
	<script src="js/jquery.scrollUp.min.js"></script>
	<!-- Niceselect JS -->
	<script src="js/niceselect.js"></script>
	<!-- Tilt Jquery JS -->
	<script src="js/tilt.jquery.min.js"></script>
	<!-- Owl Carousel JS -->
	<script src="js/owl-carousel.js"></script>
	<!-- counterup JS -->
	<script src="js/jquery.counterup.min.js"></script>
	<!-- Steller JS -->
	<script src="js/steller.js"></script>
	<!-- Wow JS -->
	<script src="js/wow.min.js"></script>
	<!-- Magnific Popup JS -->
	<script src="js/jquery.magnific-popup.min.js"></script>
	<!-- Counter Up CDN JS -->
	<script src="http://cdnjs.cloudflare.com/ajax/libs/waypoints/2.0.3/waypoints.min.js"></script>
	<!-- Bootstrap JS -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Main JS -->
	<script src="js/main.js"></script>
	<script src="js/jquery.min.js"></script>

	<script type="module">
		// Import the functions you need from the SDKs you need
		import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
		import { getFirestore, addDoc, collection, getDocs } from 'https://www.gstatic.com/firebasejs/9.12.1/firebase-firestore.js'
		// import { sendSMS } from './app.js'

		// TODO: Add SDKs for Firebase products that you want to use
		// https://firebase.google.com/docs/web/setup#available-libraries

		// Your web app's Firebase configuration
		// For Firebase JS SDK v7.20.0 and later, measurementId is optional
		const firebaseConfig = {
			apiKey: "AIzaSyDqMPxgQ40hFMdspvrbLWSEvAV-dEVn7KI",
			authDomain: "miniproject-acde9.firebaseapp.com",
			projectId: "miniproject-acde9",
			storageBucket: "miniproject-acde9.appspot.com",
			messagingSenderId: "406037940298",
			appId: "1:406037940298:web:2e6059ab91edcb3a103eb3"
		};

		// Initialize Firebase
		const app = initializeApp(firebaseConfig);
		const db = getFirestore(app);
		// const messaging = app.messaging()

		window.onload = async function () {
			const querySnapshotAppoinment = await getDocs(collection(db, "appointment"));
			let i = 0;
			const tbodyAppoinment = document.getElementById("tbodyAppoinment");
			const reversedDocsAppoinment = querySnapshotAppoinment.docs.reverse(); // Reverse the array of documents

			reversedDocsAppoinment.forEach((doc) => {
				console.log(doc.data());
				i++;
				const row = tbodyAppoinment.insertRow(-1);
				row.insertCell(-1).innerHTML = i;
				row.insertCell(-1).innerHTML = doc.data().Name;
				row.insertCell(-1).innerHTML = doc.data().Email;
				row.insertCell(-1).innerHTML = doc.data().Phone;
				row.insertCell(-1).innerHTML = doc.data().Dept;
				row.insertCell(-1).innerHTML = doc.data().Doctor;
				row.insertCell(-1).innerHTML = doc.data().Date;
				row.insertCell(-1).innerHTML = doc.data().Message;
				// Create approve button with event listener
				const approveBtn = document.createElement('button');
				approveBtn.type = 'button';
				approveBtn.className = 'btn btn-danger';
				approveBtn.textContent = 'Approve';

				approveBtn.addEventListener('click', function (event) {
					const phoneNumber = '+91' + doc.data().Phone; // Preset phone number with country code for India
					const message = `Your appointment ${i} has been approved.`; // Message for approval

					// Make a fetch request to your API endpoint
					fetch(`https://med-man.onrender.com/send-sms?phone=${phoneNumber}&message=${message}`, {
						method: 'GET',
						headers: { 
							'Content-Type': 'application/json'
						},
					})
						.then(response => {
							if (response.ok) {
								console.log('SMS sent successfully!');
								// Optionally, you can handle the response here
							} else {
								console.error('Error sending SMS:', response.statusText);
								// Optionally, you can handle errors here
							}
						})
						.catch(error => {
							console.error('Error sending SMS:', error);
							// Handle network errors or other exceptions here
						});
					// });

				});

				row.insertCell(-1).appendChild(approveBtn);

				// Create reject button with event listener
				const rejectBtn = document.createElement('button');
				rejectBtn.type = 'button';
				rejectBtn.className = 'btn btn-danger';
				rejectBtn.textContent = 'Reject';
				rejectBtn.addEventListener('click', function (event) {
					const phoneNumber = '+91' + doc.data().Phone; // Preset phone number with country code for India
					const message = `Your appointment ${i + 1} has been rejected.`; // Message for rejection

					// Make a fetch request to your API endpoint
					fetch(`https://med-man.onrender.com/send-sms?phone=${phoneNumber}&message=${message}`, {
						method: 'GET',
						headers: {
							'Content-Type': 'application/json'
						},
					})
						.then(response => {
							if (response.ok) {
								console.log('SMS sent successfully!');
								// Optionally, you can handle the response here
							} else {
								console.error('Error sending SMS:', response.statusText);
								// Optionally, you can handle errors here
							}
						})
						.catch(error => {
							console.error('Error sending SMS:', error);
							// Handle network errors or other exceptions here
						});
					// });

				});
				row.insertCell(-1).appendChild(rejectBtn);
			});


			const querySnapshotPrescripition = await getDocs(collection(db, "Prescripition"));
			i = 0;
			const tbodyPrescripition = document.getElementById("tbodyPrescripition");
			const reversedDocsPrescripition = querySnapshotPrescripition.docs.reverse(); // Reverse the array of documents
			reversedDocsPrescripition.forEach((doc) => {
				console.log(doc.data());
				i++;
				const row = tbodyPrescripition.insertRow(-1); // Changed insertRow(0) to insertRow(-1) to append rows at the end
				row.insertCell(-1).innerHTML = i;
				row.insertCell(-1).innerHTML = doc.data().First_Name;
				row.insertCell(-1).innerHTML = doc.data().Last_Name;
				row.insertCell(-1).innerHTML = doc.data().Op_number;
				row.insertCell(-1).innerHTML = doc.data().Dept; // Changed 'Dept' to 'Department' to match your table header
				row.insertCell(-1).innerHTML = doc.data().Checkup; // Changed 'date' to 'Date' to match your table header
				row.insertCell(-1).innerHTML = doc.data().Prescription;
			});

			const querySnapshotFeedback = await getDocs(collection(db, "feedback"));
			i = 0;
			const tbodyFeedback = document.getElementById("tbodyFeedback");
			const reversedDocsFeedback = querySnapshotFeedback.docs.reverse(); // Reverse the array of documents

			reversedDocsFeedback.forEach((doc) => {
				console.log(doc.data());
				i++;
				const row = tbodyFeedback.insertRow(-1); // Changed insertRow(0) to insertRow(-1) to append rows at the end
				row.insertCell(-1).innerHTML = i;
				row.insertCell(-1).innerHTML = doc.data().Name;
				row.insertCell(-1).innerHTML = doc.data().Email;
				row.insertCell(-1).innerHTML = doc.data().Phone;
				row.insertCell(-1).innerHTML = doc.data().Subject;
				row.insertCell(-1).innerHTML = doc.data().Message;
			});


		}




	</script>
	<!-- <script src="app.js"></script> -->

</body>

</html>
